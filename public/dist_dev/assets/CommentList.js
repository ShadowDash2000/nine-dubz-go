const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MobileActionPanel.js","assets/index.js","assets/index.css","assets/index2.js","assets/index3.js"])))=>i.map(i=>d[i]);
import{ab as E,r,C as Q,H as R,G as Le,bh as _e,g as Ae,m as Te,p as v,n as He,a5 as Fe,a8 as ae,az as We,bi as se,bj as Ge,b5 as ke,aW as ce,Y as q,V as qe,bk as De,bl as re,bm as Xe,bn as Ke,X as Ve,Z as oe,bo as Je,F as Y,bp as me,j as n,bd as de,bq as Z,I as Ye,B as A,_ as Qe,u as Ze,bc as Ue,aG as et,br as F,bs as ge,b9 as pe,bt as tt,b2 as nt}from"./index.js";import{F as le}from"./index2.js";import{e as it,P as at,S as st}from"./index3.js";const U=E.createContext({});U.Consumer;var ue=function(t,e){var a={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(a[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(a[i[s]]=t[i[s]]);return a};const rt=t=>{var{prefixCls:e,className:a,avatar:i,title:s,description:g}=t,c=ue(t,["prefixCls","className","avatar","title","description"]);const{getPrefixCls:m}=r.useContext(Q),o=m("list",e),d=R(`${o}-item-meta`,a),u=E.createElement("div",{className:`${o}-item-meta-content`},s&&E.createElement("h4",{className:`${o}-item-meta-title`},s),g&&E.createElement("div",{className:`${o}-item-meta-description`},g));return E.createElement("div",Object.assign({},c,{className:d}),i&&E.createElement("div",{className:`${o}-item-meta-avatar`},i),(s||g)&&u)},ot=E.forwardRef((t,e)=>{const{prefixCls:a,children:i,actions:s,extra:g,styles:c,className:m,classNames:o,colStyle:d}=t,u=ue(t,["prefixCls","children","actions","extra","styles","className","classNames","colStyle"]),{grid:l,itemLayout:x}=r.useContext(U),{getPrefixCls:I,list:p}=r.useContext(Q),f=b=>{var y,M;return R((M=(y=p==null?void 0:p.item)===null||y===void 0?void 0:y.classNames)===null||M===void 0?void 0:M[b],o==null?void 0:o[b])},C=b=>{var y,M;return Object.assign(Object.assign({},(M=(y=p==null?void 0:p.item)===null||y===void 0?void 0:y.styles)===null||M===void 0?void 0:M[b]),c==null?void 0:c[b])},P=()=>{let b=!1;return r.Children.forEach(i,y=>{typeof y=="string"&&(b=!0)}),b&&r.Children.count(i)>1},z=()=>x==="vertical"?!!g:!P(),$=I("list",a),N=(s==null?void 0:s.length)&&E.createElement("ul",{className:R(`${$}-item-action`,f("actions")),key:"actions",style:C("actions")},s.map((b,y)=>E.createElement("li",{key:`${$}-item-action-${y}`},b,y!==s.length-1&&E.createElement("em",{className:`${$}-item-action-split`})))),L=l?"div":"li",B=E.createElement(L,Object.assign({},u,l?{}:{ref:e},{className:R(`${$}-item`,{[`${$}-item-no-flex`]:!z()},m)}),x==="vertical"&&g?[E.createElement("div",{className:`${$}-item-main`,key:"content"},i,N),E.createElement("div",{className:R(`${$}-item-extra`,f("extra")),key:"extra",style:C("extra")},g)]:[i,N,Le(g,{key:"extra"})]);return l?E.createElement(_e,{ref:e,flex:1,style:d},B):B}),xe=ot;xe.Meta=rt;const lt=t=>{const{listBorderedCls:e,componentCls:a,paddingLG:i,margin:s,itemPaddingSM:g,itemPaddingLG:c,marginLG:m,borderRadiusLG:o}=t;return{[`${e}`]:{border:`${v(t.lineWidth)} ${t.lineType} ${t.colorBorder}`,borderRadius:o,[`${a}-header,${a}-footer,${a}-item`]:{paddingInline:i},[`${a}-pagination`]:{margin:`${v(s)} ${v(m)}`}},[`${e}${a}-sm`]:{[`${a}-item,${a}-header,${a}-footer`]:{padding:g}},[`${e}${a}-lg`]:{[`${a}-item,${a}-header,${a}-footer`]:{padding:c}}}},ct=t=>{const{componentCls:e,screenSM:a,screenMD:i,marginLG:s,marginSM:g,margin:c}=t;return{[`@media screen and (max-width:${i}px)`]:{[`${e}`]:{[`${e}-item`]:{[`${e}-item-action`]:{marginInlineStart:s}}},[`${e}-vertical`]:{[`${e}-item`]:{[`${e}-item-extra`]:{marginInlineStart:s}}}},[`@media screen and (max-width: ${a}px)`]:{[`${e}`]:{[`${e}-item`]:{flexWrap:"wrap",[`${e}-action`]:{marginInlineStart:g}}},[`${e}-vertical`]:{[`${e}-item`]:{flexWrap:"wrap-reverse",[`${e}-item-main`]:{minWidth:t.contentWidth},[`${e}-item-extra`]:{margin:`auto auto ${v(c)}`}}}}}},mt=t=>{const{componentCls:e,antCls:a,controlHeight:i,minHeight:s,paddingSM:g,marginLG:c,padding:m,itemPadding:o,colorPrimary:d,itemPaddingSM:u,itemPaddingLG:l,paddingXS:x,margin:I,colorText:p,colorTextDescription:f,motionDurationSlow:C,lineWidth:P,headerBg:z,footerBg:$,emptyTextPadding:N,metaMarginBottom:L,avatarMarginRight:B,titleMarginBottom:b,descriptionFontSize:y}=t;return{[`${e}`]:Object.assign(Object.assign({},He(t)),{position:"relative","*":{outline:"none"},[`${e}-header`]:{background:z},[`${e}-footer`]:{background:$},[`${e}-header, ${e}-footer`]:{paddingBlock:g},[`${e}-pagination`]:{marginBlockStart:c,[`${a}-pagination-options`]:{textAlign:"start"}},[`${e}-spin`]:{minHeight:s,textAlign:"center"},[`${e}-items`]:{margin:0,padding:0,listStyle:"none"},[`${e}-item`]:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:o,color:p,[`${e}-item-meta`]:{display:"flex",flex:1,alignItems:"flex-start",maxWidth:"100%",[`${e}-item-meta-avatar`]:{marginInlineEnd:B},[`${e}-item-meta-content`]:{flex:"1 0",width:0,color:p},[`${e}-item-meta-title`]:{margin:`0 0 ${v(t.marginXXS)} 0`,color:p,fontSize:t.fontSize,lineHeight:t.lineHeight,"> a":{color:p,transition:`all ${C}`,"&:hover":{color:d}}},[`${e}-item-meta-description`]:{color:f,fontSize:y,lineHeight:t.lineHeight}},[`${e}-item-action`]:{flex:"0 0 auto",marginInlineStart:t.marginXXL,padding:0,fontSize:0,listStyle:"none","& > li":{position:"relative",display:"inline-block",padding:`0 ${v(x)}`,color:f,fontSize:t.fontSize,lineHeight:t.lineHeight,textAlign:"center","&:first-child":{paddingInlineStart:0}},[`${e}-item-action-split`]:{position:"absolute",insetBlockStart:"50%",insetInlineEnd:0,width:P,height:t.calc(t.fontHeight).sub(t.calc(t.marginXXS).mul(2)).equal(),transform:"translateY(-50%)",backgroundColor:t.colorSplit}}},[`${e}-empty`]:{padding:`${v(m)} 0`,color:f,fontSize:t.fontSizeSM,textAlign:"center"},[`${e}-empty-text`]:{padding:N,color:t.colorTextDisabled,fontSize:t.fontSize,textAlign:"center"},[`${e}-item-no-flex`]:{display:"block"}}),[`${e}-grid ${a}-col > ${e}-item`]:{display:"block",maxWidth:"100%",marginBlockEnd:I,paddingBlock:0,borderBlockEnd:"none"},[`${e}-vertical ${e}-item`]:{alignItems:"initial",[`${e}-item-main`]:{display:"block",flex:1},[`${e}-item-extra`]:{marginInlineStart:c},[`${e}-item-meta`]:{marginBlockEnd:L,[`${e}-item-meta-title`]:{marginBlockStart:0,marginBlockEnd:b,color:p,fontSize:t.fontSizeLG,lineHeight:t.lineHeightLG}},[`${e}-item-action`]:{marginBlockStart:m,marginInlineStart:"auto","> li":{padding:`0 ${v(m)}`,"&:first-child":{paddingInlineStart:0}}}},[`${e}-split ${e}-item`]:{borderBlockEnd:`${v(t.lineWidth)} ${t.lineType} ${t.colorSplit}`,"&:last-child":{borderBlockEnd:"none"}},[`${e}-split ${e}-header`]:{borderBlockEnd:`${v(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-split${e}-empty ${e}-footer`]:{borderTop:`${v(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-loading ${e}-spin-nested-loading`]:{minHeight:i},[`${e}-split${e}-something-after-last-item ${a}-spin-container > ${e}-items > ${e}-item:last-child`]:{borderBlockEnd:`${v(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-lg ${e}-item`]:{padding:l},[`${e}-sm ${e}-item`]:{padding:u},[`${e}:not(${e}-vertical)`]:{[`${e}-item-no-flex`]:{[`${e}-item-action`]:{float:"right"}}}}},dt=t=>({contentWidth:220,itemPadding:`${v(t.paddingContentVertical)} 0`,itemPaddingSM:`${v(t.paddingContentVerticalSM)} ${v(t.paddingContentHorizontal)}`,itemPaddingLG:`${v(t.paddingContentVerticalLG)} ${v(t.paddingContentHorizontalLG)}`,headerBg:"transparent",footerBg:"transparent",emptyTextPadding:t.padding,metaMarginBottom:t.padding,avatarMarginRight:t.padding,titleMarginBottom:t.paddingSM,descriptionFontSize:t.fontSize}),gt=Ae("List",t=>{const e=Te(t,{listBorderedCls:`${t.componentCls}-bordered`,minHeight:t.controlHeightLG});return[mt(e),lt(e),ct(e)]},dt);var pt=function(t,e){var a={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(a[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(t);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(a[i[s]]=t[i[s]]);return a};function T(t){var{pagination:e=!1,prefixCls:a,bordered:i=!1,split:s=!0,className:g,rootClassName:c,style:m,children:o,itemLayout:d,loadMore:u,grid:l,dataSource:x=[],size:I,header:p,footer:f,loading:C=!1,rowKey:P,renderItem:z,locale:$}=t,N=pt(t,["pagination","prefixCls","bordered","split","className","rootClassName","style","children","itemLayout","loadMore","grid","dataSource","size","header","footer","loading","rowKey","renderItem","locale"]);const L=e&&typeof e=="object"?e:{},[B,b]=r.useState(L.defaultCurrent||1),[y,M]=r.useState(L.defaultPageSize||10),{getPrefixCls:ye,renderEmpty:D,direction:Ce,list:H}=r.useContext(Q),be={current:1,total:0},ee=h=>(j,O)=>{var J;b(j),M(O),e&&((J=e==null?void 0:e[h])===null||J===void 0||J.call(e,j,O))},Se=ee("onChange"),je=ee("onShowSizeChange"),Ie=(h,j)=>{if(!z)return null;let O;return typeof P=="function"?O=P(h):P?O=h[P]:O=h.key,O||(O=`list-item-${j}`),r.createElement(r.Fragment,{key:O},z(h,j))},Pe=()=>!!(u||e||f),S=ye("list",a),[Ne,Ee,ze]=gt(S);let _=C;typeof _=="boolean"&&(_={spinning:_});const X=!!(_!=null&&_.spinning),we=Fe(I);let W="";switch(we){case"large":W="lg";break;case"small":W="sm";break}const Oe=R(S,{[`${S}-vertical`]:d==="vertical",[`${S}-${W}`]:W,[`${S}-split`]:s,[`${S}-bordered`]:i,[`${S}-loading`]:X,[`${S}-grid`]:!!l,[`${S}-something-after-last-item`]:Pe(),[`${S}-rtl`]:Ce==="rtl"},H==null?void 0:H.className,g,c,Ee,ze),w=it(be,{total:x.length,current:B,pageSize:y},e||{}),te=Math.ceil(w.total/w.pageSize);w.current>te&&(w.current=te);const ne=e&&r.createElement("div",{className:R(`${S}-pagination`)},r.createElement(at,Object.assign({},w,{onChange:Se,onShowSizeChange:je})));let K=ae(x);e&&x.length>(w.current-1)*w.pageSize&&(K=ae(x).splice((w.current-1)*w.pageSize,w.pageSize));const Be=Object.keys(l||{}).some(h=>["xs","sm","md","lg","xl","xxl"].includes(h)),ie=We(Be),G=r.useMemo(()=>{for(let h=0;h<se.length;h+=1){const j=se[h];if(ie[j])return j}},[ie]),Me=r.useMemo(()=>{if(!l)return;const h=G&&l[G]?l[G]:l.column;if(h)return{width:`${100/h}%`,maxWidth:`${100/h}%`}},[JSON.stringify(l),G]);let V=X&&r.createElement("div",{style:{minHeight:53}});if(K.length>0){const h=K.map((j,O)=>Ie(j,O));V=l?r.createElement(Ge,{gutter:l.gutter},r.Children.map(h,j=>r.createElement("div",{key:j==null?void 0:j.key,style:Me},j))):r.createElement("ul",{className:`${S}-items`},h)}else!o&&!X&&(V=r.createElement("div",{className:`${S}-empty-text`},($==null?void 0:$.emptyText)||(D==null?void 0:D("List"))||r.createElement(ke,{componentName:"List"})));const k=w.position||"bottom",Re=r.useMemo(()=>({grid:l,itemLayout:d}),[JSON.stringify(l),d]);return Ne(r.createElement(U.Provider,{value:Re},r.createElement("div",Object.assign({style:Object.assign(Object.assign({},H==null?void 0:H.style),m),className:Oe},N),(k==="top"||k==="both")&&ne,p&&r.createElement("div",{className:`${S}-header`},p),r.createElement(st,Object.assign({},_),V,o),f&&r.createElement("div",{className:`${S}-footer`},f),u||(k==="bottom"||k==="both")&&ne)))}T.Item=xe;var ut={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M573 421c-23.1 0-41 17.9-41 40s17.9 40 41 40c21.1 0 39-17.9 39-40s-17.9-40-39-40zm-280 0c-23.1 0-41 17.9-41 40s17.9 40 41 40c21.1 0 39-17.9 39-40s-17.9-40-39-40z"}},{tag:"path",attrs:{d:"M894 345a343.92 343.92 0 00-189-130v.1c-17.1-19-36.4-36.5-58-52.1-163.7-119-393.5-82.7-513 81-96.3 133-92.2 311.9 6 439l.8 132.6c0 3.2.5 6.4 1.5 9.4a31.95 31.95 0 0040.1 20.9L309 806c33.5 11.9 68.1 18.7 102.5 20.6l-.5.4c89.1 64.9 205.9 84.4 313 49l127.1 41.4c3.2 1 6.5 1.6 9.9 1.6 17.7 0 32-14.3 32-32V753c88.1-119.6 90.4-284.9 1-408zM323 735l-12-5-99 31-1-104-8-9c-84.6-103.2-90.2-251.9-11-361 96.4-132.2 281.2-161.4 413-66 132.2 96.1 161.5 280.6 66 412-80.1 109.9-223.5 150.5-348 102zm505-17l-8 10 1 104-98-33-12 5c-56 20.8-115.7 22.5-171 7l-.2-.1A367.31 367.31 0 00729 676c76.4-105.3 88.8-237.6 44.4-350.4l.6.4c23 16.5 44.1 37.1 62 62 72.6 99.6 68.5 235.2-8 330z"}},{tag:"path",attrs:{d:"M433 421c-23.1 0-41 17.9-41 40s17.9 40 41 40c21.1 0 39-17.9 39-40s-17.9-40-39-40z"}}]},name:"comment",theme:"outlined"},xt=function(e,a){return r.createElement(ce,q({},e,{ref:a,icon:ut}))},ft=r.forwardRef(xt),ht={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},$t=function(e,a){return r.createElement(ce,q({},e,{ref:a,icon:ht}))},vt=r.forwardRef($t),yt=["className","component","viewBox","spin","rotate","tabIndex","onClick","children"],fe=r.forwardRef(function(t,e){var a=t.className,i=t.component,s=t.viewBox,g=t.spin,c=t.rotate,m=t.tabIndex,o=t.onClick,d=t.children,u=qe(t,yt),l=r.useRef(),x=De(l,e);re(!!(i||d),"Should have `component` prop or `children`."),Xe(l);var I=r.useContext(Ke),p=I.prefixCls,f=p===void 0?"anticon":p,C=I.rootClassName,P=R(C,f,a),z=R(Ve({},"".concat(f,"-spin"),!!g)),$=c?{msTransform:"rotate(".concat(c,"deg)"),transform:"rotate(".concat(c,"deg)")}:void 0,N=oe(oe({},Je),{},{className:z,style:$,viewBox:s});s||delete N.viewBox;var L=function(){return i?r.createElement(i,N,d):d?(re(!!s||r.Children.count(d)===1&&r.isValidElement(d)&&r.Children.only(d).type==="use","Make sure that you provide correct `viewBox` prop (default `0 0 1024 1024`) to the icon."),r.createElement("svg",q({},N,{viewBox:s}),d)):null},B=m;return B===void 0&&o&&(B=-1),r.createElement("span",q({role:"img"},u,{ref:x,tabIndex:B,onClick:o,className:P}),L())});fe.displayName="AntdIcon";const he=({code:t,parentId:e,setShowReplyPanel:a})=>{const[i]=Y.useForm(),{addReply:s}=me(),g=({text:c})=>{c&&(s({code:t,parentId:e,text:c}),i.resetFields())};return n.jsx(de,{theme:{components:{Input:{paddingInline:0,borderRadius:"0"}}},children:n.jsxs(Y,{onFinish:g,form:i,className:"pt-2 flex flex-col gap-2",children:[n.jsx(Y.Item,{className:"mb-0",name:"text",children:n.jsxs(le,{gap:6,children:[n.jsx(Z,{}),n.jsx(Ye.TextArea,{id:"replyPanel",showCount:!0,autoSize:{minRows:1},maxLength:5e3,placeholder:"Ответ",variant:"borderless"})]})}),n.jsxs(le,{justify:"end",gap:5,children:[n.jsx(A,{onClick:()=>a(!1),children:"Отмена"}),n.jsx(A,{htmlType:"submit",children:"Ответить"})]})]})})},Ct=()=>n.jsx("svg",{viewBox:"8 0 469 469",focusable:"false","data-icon":"reply",width:"15px",height:"15px",fill:"currentColor","aria-hidden":"true",children:n.jsx("path",{d:`M397.305,207.826c-67.733-59.947-161.493-61.12-194.56-59.307V74.706c0-5.867-4.8-10.667-10.667-10.667\r
			c-2.453,0-4.907,0.853-6.827,2.453L3.918,215.826c-4.587,3.733-5.227,10.453-1.493,15.04c0.427,0.533,0.96,0.96,1.493,1.493\r
			l181.333,149.333c4.587,3.733,11.307,3.093,15.04-1.493c1.6-1.92,2.453-4.267,2.453-6.827v-77.013\r
			c34.667-8,175.147-30.507,246.613,103.36c1.813,3.52,5.44,5.653,9.387,5.653c3.413,0,6.72-1.6,8.853-4.693\r
			c1.28-1.813,1.813-4.053,1.813-6.293C469.305,312.999,445.091,250.279,397.305,207.826z M260.558,269.159\r
			c-41.067,0-70.72,8.427-71.467,8.64c-4.587,1.28-7.68,5.44-7.68,10.24v62.72l-153.92-126.72l153.92-126.72v62.72\r
			c0,5.867,4.8,10.667,10.667,10.667c0.427,0,0.853,0,1.28-0.107c1.173-0.107,115.2-12.907,189.76,53.227\r
			c35.2,31.147,56.213,75.2,62.72,130.987C391.758,284.306,315.811,269.159,260.558,269.159z`})}),bt=r.lazy(()=>Qe(()=>import("./MobileActionPanel.js"),__vite__mapDeps([0,1,2,3,4]))),St=({code:t,commentId:e,setShowReplyPanel:a,userId:i,parentId:s})=>{const g=Ze(d=>{var u;return(u=d.userInfo)==null?void 0:u.id}),[c,m]=r.useState(!1),{deleteComment:o}=me();return n.jsxs("div",{className:"flex gap-[2px] items-center md-mobile:ml-auto",children:[n.jsxs("div",{className:"md-mobile:hidden",children:[n.jsx(A,{size:"small",type:"text",shape:"circle",onClick:()=>a(!0),icon:n.jsx(fe,{component:Ct,className:"text-[14px]"})}),g===i&&n.jsx(A,{size:"small",type:"text",shape:"circle",onClick:()=>o({code:t,commentId:e,parentId:s}),icon:n.jsx(Ue,{className:"text-[14px]"})})]}),n.jsx(A,{shape:"circle",type:"text",onClick:()=>m(!0),className:"hidden md-mobile:flex md-mobile:items-center md-mobile:justify-center md-mobile:text-xl",children:n.jsx(vt,{className:"text-white"})}),c&&et.createPortal(n.jsx(bt,{setIsOpenMobileMenu:m,isOpenMobileMenu:c,getShortId:g,parentId:s,commentId:e,userId:i,code:t}),document.body,"mobileActionPanel")]})},$e=({title:t,createdAt:e,...a})=>n.jsxs("div",{className:"flex gap-[6px] items-center",children:[n.jsx("p",{className:"text-gray-200",children:t}),n.jsx("small",{className:"text-gray-200/50",children:e}),n.jsx(St,{...a})]}),jt=({title:t,description:e,createdAt:a,code:i,userId:s,userPicture:g,parentId:c,commentId:m})=>{const[o,d]=r.useState(!1);return n.jsx(T.Item,{children:n.jsx(T.Item.Meta,{avatar:n.jsx(Z,{src:`http://localhost:25565/api/file/${g}`}),title:n.jsx($e,{title:t,createdAt:a,code:i,userId:s,commentId:m,setShowReplyPanel:d,parentId:c}),description:n.jsxs(n.Fragment,{children:[n.jsx("p",{className:"text-gray-200 text-[15px] break-all",children:e}),o&&n.jsx(he,{code:i,parentId:c,commentId:m,setShowReplyPanel:d})]})})})},It=({code:t,refetch:e,parentId:a,isLoading:i,setOffset:s,showReplyList:g,setShowReplyList:c,subCommentsCount:m})=>{const o=F(l=>l.subCommentList)[a],d=F(l=>l.commentList)["a"+a].subCommentsCount,u=async()=>{await s(l=>l+10),e()};return n.jsxs(n.Fragment,{children:[n.jsxs(A,{className:"my-2 p-3 rounded-[13px]",onClick:()=>c(l=>!l),children:["Показать ответы (",m||(o==null?void 0:o.length),")"]}),g&&n.jsx(T,{loading:i,dataSource:o==null?void 0:o.map(({user:l,text:x,createdAt:I,id:p,parentId:f})=>{var C;return{parentId:f,commentId:p,title:l==null?void 0:l.name,userId:l.id,description:x,userPicture:(C=l.picture)==null?void 0:C.name,createdAt:ge(I)}}),renderItem:({title:l,description:x,createdAt:I,parentId:p,userPicture:f,commentId:C,userId:P})=>n.jsx(jt,{code:t,title:l,userId:P,userPicture:f,commentId:C,parentId:p,createdAt:I,description:x})}),g&&m>10&&d-((o==null?void 0:o.length)||0)&&n.jsx(A,{className:"my-2 p-3 rounded-[13px]",onClick:u,children:"Показать больше"})]})},ve=r.createContext(null),Pt=()=>{var z,$;const[t,e]=r.useState(0),[a,i]=r.useState(!1),[s,g]=r.useState(!1),c=F(N=>N.getReply),m=F(N=>N.subCommentList),{commentId:o,code:d,title:u,createdAt:l,userId:x,description:I,subCommentsCount:p,userPicture:f}=r.useContext(ve),{isLoading:C,refetch:P}=pe({queryKey:["getReply",o],queryFn:()=>c({code:d,commentId:o,offset:t}),enabled:!((z=m[o])!=null&&z.length)&&!!s});return n.jsx(T.Item,{className:"bg-gray-400/10 rounded-[10px] mb-3 last:mb-0 items-start",children:n.jsx(T.Item.Meta,{avatar:n.jsx(Z,{src:`http://localhost:25565/api/file/${f}`}),title:n.jsx($e,{title:u,createdAt:l,code:d,userId:x,commentId:o,setShowReplyPanel:i,parentId:o}),description:n.jsxs(n.Fragment,{children:[n.jsx("p",{className:"text-gray-200 text-[15px] break-all",children:I}),(!!p||!!(($=m[o])!=null&&$.length))&&n.jsx(It,{code:d,offset:t,refetch:P,parentId:o,setOffset:e,isLoading:C,showReplyList:s,setShowReplyList:g,subCommentsCount:p}),a&&n.jsx(he,{code:d,setShowReplyPanel:i,parentId:o})]})})})},Nt=({children:t,commentValue:e})=>n.jsx(ve.Provider,{value:e,children:t}),Et=({code:t})=>{const e=F(c=>c.getComments),a=F(c=>c.commentList),i=Array(4).fill(0),{isLoading:s}=pe({queryKey:["getComments"],queryFn:async()=>e({code:t,offset:0}),enabled:!!t}),g=Object.entries(a).reduce((c,m)=>{var o,d,u,l;return m[0]==="commentsCount"?c:[...c,{userId:(o=m[1].user)==null?void 0:o.id,commentId:m[1].id,subCommentsCount:m[1].subCommentsCount,title:(d=m[1].user)==null?void 0:d.name,userPicture:(l=(u=m[1])==null?void 0:u.user.picture)==null?void 0:l.name,description:m[1].text,createdAt:ge(m[1].createdAt)}]},[]);return n.jsx(n.Fragment,{children:s?i.map((c,m)=>n.jsx(tt,{loading:s,active:!0,avatar:!0},m)):n.jsx(de,{renderEmpty:()=>n.jsx(nt,{image:n.jsx(ft,{className:"text-white/30 text-5xl"}),imageStyle:{height:"auto"},description:n.jsx("p",{className:"text-gray-200/40 max-w-[400px] mx-auto text-[15px] font-medium",children:"Будьте первым кто оставит комментарий!"})}),children:n.jsx(T,{dataSource:g,loading:s,renderItem:({title:c,description:m,createdAt:o,commentId:d,subCommentsCount:u,userId:l,userPicture:x})=>n.jsx(Nt,{commentValue:{code:t,title:c,userId:l,commentId:d,userPicture:x,description:m,subCommentsCount:u,createdAt:o},children:n.jsx(Pt,{})})})})})},Bt=Object.freeze(Object.defineProperty({__proto__:null,default:Et},Symbol.toStringTag,{value:"Module"}));export{Bt as C,fe as I,Ct as R};
