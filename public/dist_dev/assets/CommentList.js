const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MobileActionPanel.js","assets/index.js","assets/index.css","assets/index2.js","assets/index3.js"])))=>i.map(i=>d[i]);
import{ab as I,r as s,C as Q,E as R,D as Re,bh as Le,g as _e,m as Ae,n as y,k as Te,a5 as He,a8 as ae,az as Fe,bi as re,bj as We,b4 as Ge,aV as ce,Y as D,V as ke,bk as De,bl as se,bm as qe,bn as Xe,X as Ke,Z as oe,bo as Ve,F as Y,bp as de,j as i,bc as me,bq as Z,I as Je,B as A,_ as Ye,u as Qe,bb as Ze,aF as Ue,br as F,bs as ge,b8 as pe,bt as et,b1 as tt}from"./index.js";import{F as le}from"./index2.js";import{e as nt,P as it,S as at}from"./index3.js";const U=I.createContext({});U.Consumer;var ue=function(t,e){var a={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(a[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(a[n[r]]=t[n[r]]);return a};const rt=t=>{var{prefixCls:e,className:a,avatar:n,title:r,description:m}=t,c=ue(t,["prefixCls","className","avatar","title","description"]);const{getPrefixCls:o}=s.useContext(Q),d=o("list",e),g=R(`${d}-item-meta`,a),u=I.createElement("div",{className:`${d}-item-meta-content`},r&&I.createElement("h4",{className:`${d}-item-meta-title`},r),m&&I.createElement("div",{className:`${d}-item-meta-description`},m));return I.createElement("div",Object.assign({},c,{className:g}),n&&I.createElement("div",{className:`${d}-item-meta-avatar`},n),(r||m)&&u)},st=I.forwardRef((t,e)=>{const{prefixCls:a,children:n,actions:r,extra:m,styles:c,className:o,classNames:d,colStyle:g}=t,u=ue(t,["prefixCls","children","actions","extra","styles","className","classNames","colStyle"]),{grid:l,itemLayout:x}=s.useContext(U),{getPrefixCls:N,list:p}=s.useContext(Q),f=S=>{var v,M;return R((M=(v=p==null?void 0:p.item)===null||v===void 0?void 0:v.classNames)===null||M===void 0?void 0:M[S],d==null?void 0:d[S])},b=S=>{var v,M;return Object.assign(Object.assign({},(M=(v=p==null?void 0:p.item)===null||v===void 0?void 0:v.styles)===null||M===void 0?void 0:M[S]),c==null?void 0:c[S])},E=()=>{let S=!1;return s.Children.forEach(n,v=>{typeof v=="string"&&(S=!0)}),S&&s.Children.count(n)>1},z=()=>x==="vertical"?!!m:!E(),$=N("list",a),P=(r==null?void 0:r.length)&&I.createElement("ul",{className:R(`${$}-item-action`,f("actions")),key:"actions",style:b("actions")},r.map((S,v)=>I.createElement("li",{key:`${$}-item-action-${v}`},S,v!==r.length-1&&I.createElement("em",{className:`${$}-item-action-split`})))),L=l?"div":"li",B=I.createElement(L,Object.assign({},u,l?{}:{ref:e},{className:R(`${$}-item`,{[`${$}-item-no-flex`]:!z()},o)}),x==="vertical"&&m?[I.createElement("div",{className:`${$}-item-main`,key:"content"},n,P),I.createElement("div",{className:R(`${$}-item-extra`,f("extra")),key:"extra",style:b("extra")},m)]:[n,P,Re(m,{key:"extra"})]);return l?I.createElement(Le,{ref:e,flex:1,style:g},B):B}),xe=st;xe.Meta=rt;const ot=t=>{const{listBorderedCls:e,componentCls:a,paddingLG:n,margin:r,itemPaddingSM:m,itemPaddingLG:c,marginLG:o,borderRadiusLG:d}=t;return{[`${e}`]:{border:`${y(t.lineWidth)} ${t.lineType} ${t.colorBorder}`,borderRadius:d,[`${a}-header,${a}-footer,${a}-item`]:{paddingInline:n},[`${a}-pagination`]:{margin:`${y(r)} ${y(o)}`}},[`${e}${a}-sm`]:{[`${a}-item,${a}-header,${a}-footer`]:{padding:m}},[`${e}${a}-lg`]:{[`${a}-item,${a}-header,${a}-footer`]:{padding:c}}}},lt=t=>{const{componentCls:e,screenSM:a,screenMD:n,marginLG:r,marginSM:m,margin:c}=t;return{[`@media screen and (max-width:${n}px)`]:{[`${e}`]:{[`${e}-item`]:{[`${e}-item-action`]:{marginInlineStart:r}}},[`${e}-vertical`]:{[`${e}-item`]:{[`${e}-item-extra`]:{marginInlineStart:r}}}},[`@media screen and (max-width: ${a}px)`]:{[`${e}`]:{[`${e}-item`]:{flexWrap:"wrap",[`${e}-action`]:{marginInlineStart:m}}},[`${e}-vertical`]:{[`${e}-item`]:{flexWrap:"wrap-reverse",[`${e}-item-main`]:{minWidth:t.contentWidth},[`${e}-item-extra`]:{margin:`auto auto ${y(c)}`}}}}}},ct=t=>{const{componentCls:e,antCls:a,controlHeight:n,minHeight:r,paddingSM:m,marginLG:c,padding:o,itemPadding:d,colorPrimary:g,itemPaddingSM:u,itemPaddingLG:l,paddingXS:x,margin:N,colorText:p,colorTextDescription:f,motionDurationSlow:b,lineWidth:E,headerBg:z,footerBg:$,emptyTextPadding:P,metaMarginBottom:L,avatarMarginRight:B,titleMarginBottom:S,descriptionFontSize:v}=t;return{[`${e}`]:Object.assign(Object.assign({},Te(t)),{position:"relative","*":{outline:"none"},[`${e}-header`]:{background:z},[`${e}-footer`]:{background:$},[`${e}-header, ${e}-footer`]:{paddingBlock:m},[`${e}-pagination`]:{marginBlockStart:c,[`${a}-pagination-options`]:{textAlign:"start"}},[`${e}-spin`]:{minHeight:r,textAlign:"center"},[`${e}-items`]:{margin:0,padding:0,listStyle:"none"},[`${e}-item`]:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:d,color:p,[`${e}-item-meta`]:{display:"flex",flex:1,alignItems:"flex-start",maxWidth:"100%",[`${e}-item-meta-avatar`]:{marginInlineEnd:B},[`${e}-item-meta-content`]:{flex:"1 0",width:0,color:p},[`${e}-item-meta-title`]:{margin:`0 0 ${y(t.marginXXS)} 0`,color:p,fontSize:t.fontSize,lineHeight:t.lineHeight,"> a":{color:p,transition:`all ${b}`,"&:hover":{color:g}}},[`${e}-item-meta-description`]:{color:f,fontSize:v,lineHeight:t.lineHeight}},[`${e}-item-action`]:{flex:"0 0 auto",marginInlineStart:t.marginXXL,padding:0,fontSize:0,listStyle:"none","& > li":{position:"relative",display:"inline-block",padding:`0 ${y(x)}`,color:f,fontSize:t.fontSize,lineHeight:t.lineHeight,textAlign:"center","&:first-child":{paddingInlineStart:0}},[`${e}-item-action-split`]:{position:"absolute",insetBlockStart:"50%",insetInlineEnd:0,width:E,height:t.calc(t.fontHeight).sub(t.calc(t.marginXXS).mul(2)).equal(),transform:"translateY(-50%)",backgroundColor:t.colorSplit}}},[`${e}-empty`]:{padding:`${y(o)} 0`,color:f,fontSize:t.fontSizeSM,textAlign:"center"},[`${e}-empty-text`]:{padding:P,color:t.colorTextDisabled,fontSize:t.fontSize,textAlign:"center"},[`${e}-item-no-flex`]:{display:"block"}}),[`${e}-grid ${a}-col > ${e}-item`]:{display:"block",maxWidth:"100%",marginBlockEnd:N,paddingBlock:0,borderBlockEnd:"none"},[`${e}-vertical ${e}-item`]:{alignItems:"initial",[`${e}-item-main`]:{display:"block",flex:1},[`${e}-item-extra`]:{marginInlineStart:c},[`${e}-item-meta`]:{marginBlockEnd:L,[`${e}-item-meta-title`]:{marginBlockStart:0,marginBlockEnd:S,color:p,fontSize:t.fontSizeLG,lineHeight:t.lineHeightLG}},[`${e}-item-action`]:{marginBlockStart:o,marginInlineStart:"auto","> li":{padding:`0 ${y(o)}`,"&:first-child":{paddingInlineStart:0}}}},[`${e}-split ${e}-item`]:{borderBlockEnd:`${y(t.lineWidth)} ${t.lineType} ${t.colorSplit}`,"&:last-child":{borderBlockEnd:"none"}},[`${e}-split ${e}-header`]:{borderBlockEnd:`${y(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-split${e}-empty ${e}-footer`]:{borderTop:`${y(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-loading ${e}-spin-nested-loading`]:{minHeight:n},[`${e}-split${e}-something-after-last-item ${a}-spin-container > ${e}-items > ${e}-item:last-child`]:{borderBlockEnd:`${y(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-lg ${e}-item`]:{padding:l},[`${e}-sm ${e}-item`]:{padding:u},[`${e}:not(${e}-vertical)`]:{[`${e}-item-no-flex`]:{[`${e}-item-action`]:{float:"right"}}}}},dt=t=>({contentWidth:220,itemPadding:`${y(t.paddingContentVertical)} 0`,itemPaddingSM:`${y(t.paddingContentVerticalSM)} ${y(t.paddingContentHorizontal)}`,itemPaddingLG:`${y(t.paddingContentVerticalLG)} ${y(t.paddingContentHorizontalLG)}`,headerBg:"transparent",footerBg:"transparent",emptyTextPadding:t.padding,metaMarginBottom:t.padding,avatarMarginRight:t.padding,titleMarginBottom:t.paddingSM,descriptionFontSize:t.fontSize}),mt=_e("List",t=>{const e=Ae(t,{listBorderedCls:`${t.componentCls}-bordered`,minHeight:t.controlHeightLG});return[ct(e),ot(e),lt(e)]},dt);var gt=function(t,e){var a={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(a[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(a[n[r]]=t[n[r]]);return a};function T(t){var{pagination:e=!1,prefixCls:a,bordered:n=!1,split:r=!0,className:m,rootClassName:c,style:o,children:d,itemLayout:g,loadMore:u,grid:l,dataSource:x=[],size:N,header:p,footer:f,loading:b=!1,rowKey:E,renderItem:z,locale:$}=t,P=gt(t,["pagination","prefixCls","bordered","split","className","rootClassName","style","children","itemLayout","loadMore","grid","dataSource","size","header","footer","loading","rowKey","renderItem","locale"]);const L=e&&typeof e=="object"?e:{},[B,S]=s.useState(L.defaultCurrent||1),[v,M]=s.useState(L.defaultPageSize||10),{getPrefixCls:ye,renderEmpty:q,direction:ve,list:H}=s.useContext(Q),be={current:1,total:0},ee=h=>(j,O)=>{var J;S(j),M(O),e&&((J=e==null?void 0:e[h])===null||J===void 0||J.call(e,j,O))},Se=ee("onChange"),Ce=ee("onShowSizeChange"),je=(h,j)=>{if(!z)return null;let O;return typeof E=="function"?O=E(h):E?O=h[E]:O=h.key,O||(O=`list-item-${j}`),s.createElement(s.Fragment,{key:O},z(h,j))},Ne=()=>!!(u||e||f),C=ye("list",a),[Ee,Pe,Ie]=mt(C);let _=b;typeof _=="boolean"&&(_={spinning:_});const X=!!(_!=null&&_.spinning),ze=He(N);let W="";switch(ze){case"large":W="lg";break;case"small":W="sm";break}const we=R(C,{[`${C}-vertical`]:g==="vertical",[`${C}-${W}`]:W,[`${C}-split`]:r,[`${C}-bordered`]:n,[`${C}-loading`]:X,[`${C}-grid`]:!!l,[`${C}-something-after-last-item`]:Ne(),[`${C}-rtl`]:ve==="rtl"},H==null?void 0:H.className,m,c,Pe,Ie),w=nt(be,{total:x.length,current:B,pageSize:v},e||{}),te=Math.ceil(w.total/w.pageSize);w.current>te&&(w.current=te);const ne=e&&s.createElement("div",{className:R(`${C}-pagination`)},s.createElement(it,Object.assign({},w,{onChange:Se,onShowSizeChange:Ce})));let K=ae(x);e&&x.length>(w.current-1)*w.pageSize&&(K=ae(x).splice((w.current-1)*w.pageSize,w.pageSize));const Oe=Object.keys(l||{}).some(h=>["xs","sm","md","lg","xl","xxl"].includes(h)),ie=Fe(Oe),G=s.useMemo(()=>{for(let h=0;h<re.length;h+=1){const j=re[h];if(ie[j])return j}},[ie]),Be=s.useMemo(()=>{if(!l)return;const h=G&&l[G]?l[G]:l.column;if(h)return{width:`${100/h}%`,maxWidth:`${100/h}%`}},[JSON.stringify(l),G]);let V=X&&s.createElement("div",{style:{minHeight:53}});if(K.length>0){const h=K.map((j,O)=>je(j,O));V=l?s.createElement(We,{gutter:l.gutter},s.Children.map(h,j=>s.createElement("div",{key:j==null?void 0:j.key,style:Be},j))):s.createElement("ul",{className:`${C}-items`},h)}else!d&&!X&&(V=s.createElement("div",{className:`${C}-empty-text`},($==null?void 0:$.emptyText)||(q==null?void 0:q("List"))||s.createElement(Ge,{componentName:"List"})));const k=w.position||"bottom",Me=s.useMemo(()=>({grid:l,itemLayout:g}),[JSON.stringify(l),g]);return Ee(s.createElement(U.Provider,{value:Me},s.createElement("div",Object.assign({style:Object.assign(Object.assign({},H==null?void 0:H.style),o),className:we},P),(k==="top"||k==="both")&&ne,p&&s.createElement("div",{className:`${C}-header`},p),s.createElement(at,Object.assign({},_),V,d),f&&s.createElement("div",{className:`${C}-footer`},f),u||(k==="bottom"||k==="both")&&ne)))}T.Item=xe;var pt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M573 421c-23.1 0-41 17.9-41 40s17.9 40 41 40c21.1 0 39-17.9 39-40s-17.9-40-39-40zm-280 0c-23.1 0-41 17.9-41 40s17.9 40 41 40c21.1 0 39-17.9 39-40s-17.9-40-39-40z"}},{tag:"path",attrs:{d:"M894 345a343.92 343.92 0 00-189-130v.1c-17.1-19-36.4-36.5-58-52.1-163.7-119-393.5-82.7-513 81-96.3 133-92.2 311.9 6 439l.8 132.6c0 3.2.5 6.4 1.5 9.4a31.95 31.95 0 0040.1 20.9L309 806c33.5 11.9 68.1 18.7 102.5 20.6l-.5.4c89.1 64.9 205.9 84.4 313 49l127.1 41.4c3.2 1 6.5 1.6 9.9 1.6 17.7 0 32-14.3 32-32V753c88.1-119.6 90.4-284.9 1-408zM323 735l-12-5-99 31-1-104-8-9c-84.6-103.2-90.2-251.9-11-361 96.4-132.2 281.2-161.4 413-66 132.2 96.1 161.5 280.6 66 412-80.1 109.9-223.5 150.5-348 102zm505-17l-8 10 1 104-98-33-12 5c-56 20.8-115.7 22.5-171 7l-.2-.1A367.31 367.31 0 00729 676c76.4-105.3 88.8-237.6 44.4-350.4l.6.4c23 16.5 44.1 37.1 62 62 72.6 99.6 68.5 235.2-8 330z"}},{tag:"path",attrs:{d:"M433 421c-23.1 0-41 17.9-41 40s17.9 40 41 40c21.1 0 39-17.9 39-40s-17.9-40-39-40z"}}]},name:"comment",theme:"outlined"},ut=function(e,a){return s.createElement(ce,D({},e,{ref:a,icon:pt}))},xt=s.forwardRef(ut),ft={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},ht=function(e,a){return s.createElement(ce,D({},e,{ref:a,icon:ft}))},$t=s.forwardRef(ht),yt=["className","component","viewBox","spin","rotate","tabIndex","onClick","children"],fe=s.forwardRef(function(t,e){var a=t.className,n=t.component,r=t.viewBox,m=t.spin,c=t.rotate,o=t.tabIndex,d=t.onClick,g=t.children,u=ke(t,yt),l=s.useRef(),x=De(l,e);se(!!(n||g),"Should have `component` prop or `children`."),qe(l);var N=s.useContext(Xe),p=N.prefixCls,f=p===void 0?"anticon":p,b=N.rootClassName,E=R(b,f,a),z=R(Ke({},"".concat(f,"-spin"),!!m)),$=c?{msTransform:"rotate(".concat(c,"deg)"),transform:"rotate(".concat(c,"deg)")}:void 0,P=oe(oe({},Ve),{},{className:z,style:$,viewBox:r});r||delete P.viewBox;var L=function(){return n?s.createElement(n,P,g):g?(se(!!r||s.Children.count(g)===1&&s.isValidElement(g)&&s.Children.only(g).type==="use","Make sure that you provide correct `viewBox` prop (default `0 0 1024 1024`) to the icon."),s.createElement("svg",D({},P,{viewBox:r}),g)):null},B=o;return B===void 0&&d&&(B=-1),s.createElement("span",D({role:"img"},u,{ref:x,tabIndex:B,onClick:d,className:E}),L())});fe.displayName="AntdIcon";const he=({code:t,parentId:e,setShowReplyPanel:a})=>{const[n]=Y.useForm(),{addReply:r}=de(),m=({text:c})=>{c&&(r({code:t,parentId:e,text:c}),n.resetFields())};return i.jsx(me,{theme:{components:{Input:{paddingInline:0,borderRadius:"0"}}},children:i.jsxs(Y,{onFinish:m,form:n,className:"pt-2 flex flex-col gap-2",children:[i.jsx(Y.Item,{className:"mb-0",name:"text",children:i.jsxs(le,{gap:6,children:[i.jsx(Z,{}),i.jsx(Je.TextArea,{id:"replyPanel",showCount:!0,autoSize:{minRows:1},maxLength:5e3,placeholder:"Ответ",variant:"borderless"})]})}),i.jsxs(le,{justify:"end",gap:5,children:[i.jsx(A,{onClick:()=>a(!1),children:"Отмена"}),i.jsx(A,{htmlType:"submit",children:"Ответить"})]})]})})},vt=()=>i.jsx("svg",{viewBox:"8 0 469 469",focusable:"false","data-icon":"reply",width:"15px",height:"15px",fill:"currentColor","aria-hidden":"true",children:i.jsx("path",{d:`M397.305,207.826c-67.733-59.947-161.493-61.12-194.56-59.307V74.706c0-5.867-4.8-10.667-10.667-10.667\r
			c-2.453,0-4.907,0.853-6.827,2.453L3.918,215.826c-4.587,3.733-5.227,10.453-1.493,15.04c0.427,0.533,0.96,0.96,1.493,1.493\r
			l181.333,149.333c4.587,3.733,11.307,3.093,15.04-1.493c1.6-1.92,2.453-4.267,2.453-6.827v-77.013\r
			c34.667-8,175.147-30.507,246.613,103.36c1.813,3.52,5.44,5.653,9.387,5.653c3.413,0,6.72-1.6,8.853-4.693\r
			c1.28-1.813,1.813-4.053,1.813-6.293C469.305,312.999,445.091,250.279,397.305,207.826z M260.558,269.159\r
			c-41.067,0-70.72,8.427-71.467,8.64c-4.587,1.28-7.68,5.44-7.68,10.24v62.72l-153.92-126.72l153.92-126.72v62.72\r
			c0,5.867,4.8,10.667,10.667,10.667c0.427,0,0.853,0,1.28-0.107c1.173-0.107,115.2-12.907,189.76,53.227\r
			c35.2,31.147,56.213,75.2,62.72,130.987C391.758,284.306,315.811,269.159,260.558,269.159z`})}),bt=s.lazy(()=>Ye(()=>import("./MobileActionPanel.js"),__vite__mapDeps([0,1,2,3,4]))),St=({code:t,commentId:e,setShowReplyPanel:a,userId:n,parentId:r})=>{const m=Qe(g=>{var u;return(u=g.userInfo)==null?void 0:u.id}),[c,o]=s.useState(!1),{deleteComment:d}=de();return i.jsxs("div",{className:"flex gap-[2px] items-center md-mobile:ml-auto",children:[i.jsxs("div",{className:"md-mobile:hidden",children:[i.jsx(A,{size:"small",type:"text",shape:"circle",onClick:()=>a(!0),icon:i.jsx(fe,{component:vt,className:"text-[14px]"})}),m===n&&i.jsx(A,{size:"small",type:"text",shape:"circle",onClick:()=>d({code:t,commentId:e,parentId:r}),icon:i.jsx(Ze,{className:"text-[14px]"})})]}),i.jsx(A,{shape:"circle",type:"text",onClick:()=>o(!0),className:"hidden md-mobile:flex md-mobile:items-center md-mobile:justify-center md-mobile:text-xl",children:i.jsx($t,{className:"text-white"})}),c&&Ue.createPortal(i.jsx(bt,{setIsOpenMobileMenu:o,isOpenMobileMenu:c,getShortId:m,parentId:r,commentId:e,userId:n,code:t}),document.body,"mobileActionPanel")]})},$e=({title:t,createdAt:e,...a})=>i.jsxs("div",{className:"flex gap-[6px] items-center",children:[i.jsx("p",{className:"text-gray-200",children:t}),i.jsx("small",{className:"text-gray-200/50",children:e}),i.jsx(St,{...a})]}),Ct=({title:t,description:e,createdAt:a,code:n,userId:r,userPicture:m,parentId:c,commentId:o})=>{const[d,g]=s.useState(!1);return i.jsx(T.Item,{children:i.jsx(T.Item.Meta,{avatar:i.jsx(Z,{src:`http://localhost:25565/api/file/${m}`}),title:i.jsx($e,{title:t,createdAt:a,code:n,userId:r,commentId:o,setShowReplyPanel:g,parentId:c}),description:i.jsxs(i.Fragment,{children:[i.jsx("p",{className:"text-gray-200 text-[15px] break-all",children:e}),d&&i.jsx(he,{code:n,parentId:c,commentId:o,setShowReplyPanel:g})]})})})},jt=({code:t,refetch:e,parentId:a,isLoading:n,setOffset:r,showReplyList:m,setShowReplyList:c,subCommentsCount:o})=>{const d=F(l=>l.subCommentList)[a],g=F(l=>l.commentList)["a"+a].subCommentsCount,u=async()=>{await r(l=>l+10),e()};return i.jsxs(i.Fragment,{children:[i.jsxs(A,{className:"my-2 p-3 rounded-[13px]",onClick:()=>c(l=>!l),children:["Показать ответы (",o||(d==null?void 0:d.length),")"]}),m&&i.jsx(T,{loading:n,dataSource:d==null?void 0:d.map(({user:l,text:x,createdAt:N,id:p,parentId:f})=>{var b;return{parentId:f,commentId:p,title:l==null?void 0:l.name,userId:l.id,description:x,userPicture:(b=l.picture)==null?void 0:b.name,createdAt:ge(N)}}),renderItem:({title:l,description:x,createdAt:N,parentId:p,userPicture:f,commentId:b,userId:E})=>i.jsx(Ct,{code:t,title:l,userId:E,userPicture:f,commentId:b,parentId:p,createdAt:N,description:x})}),m&&o>10&&g-((d==null?void 0:d.length)||0)&&i.jsx(A,{className:"my-2 p-3 rounded-[13px]",onClick:u,children:"Показать больше"})]})},Nt=({description:t,createdAt:e,title:a,code:n,subCommentsCount:r,userId:m,userPicture:c,commentId:o})=>{var z,$;const[d,g]=s.useState(0),[u,l]=s.useState(!1),[x,N]=s.useState(!1),p=F(P=>P.getReply),f=F(P=>P.subCommentList),{isLoading:b,refetch:E}=pe({queryKey:["getReply",o],queryFn:()=>p({code:n,commentId:o,offset:d}),enabled:!((z=f[o])!=null&&z.length)&&!!x});return i.jsx(T.Item,{className:"bg-gray-400/10 rounded-[10px] mb-3 last:mb-0 items-start",children:i.jsx(T.Item.Meta,{avatar:i.jsx(Z,{src:`http://localhost:25565/api/file/${c}`}),title:i.jsx($e,{title:a,createdAt:e,code:n,userId:m,commentId:o,setShowReplyPanel:l,parentId:o}),description:i.jsxs(i.Fragment,{children:[i.jsx("p",{className:"text-gray-200 text-[15px] break-all",children:t}),(!!r||!!(($=f[o])!=null&&$.length))&&i.jsx(jt,{code:n,offset:d,refetch:E,parentId:o,setOffset:g,isLoading:b,showReplyList:x,setShowReplyList:N,subCommentsCount:r}),u&&i.jsx(he,{code:n,setShowReplyPanel:l,parentId:o})]})})})},Et=({code:t})=>{const e=F(c=>c.getComments),a=F(c=>c.commentList),n=Array(4).fill(0),{isLoading:r}=pe({queryKey:["getComments"],queryFn:async()=>e({code:t,offset:0}),enabled:!!t}),m=Object.entries(a).reduce((c,o)=>{var d,g,u,l;return o[0]==="commentsCount"?c:[...c,{userId:(d=o[1].user)==null?void 0:d.id,commentId:o[1].id,subCommentsCount:o[1].subCommentsCount,title:(g=o[1].user)==null?void 0:g.name,userPicture:(l=(u=o[1])==null?void 0:u.user.picture)==null?void 0:l.name,description:o[1].text,createdAt:ge(o[1].createdAt)}]},[]);return i.jsx(i.Fragment,{children:r?n.map((c,o)=>i.jsx(et,{loading:r,active:!0,avatar:!0},o)):i.jsx(me,{renderEmpty:()=>i.jsx(tt,{image:i.jsx(xt,{style:{fontSize:"50px",color:"rgb(229 231 235 / 0.4)"}}),imageStyle:{height:"auto"},description:i.jsx("p",{className:"text-gray-200/40 max-w-[400px] mx-auto text-[17px]",children:"Будьте первым кто оставит комментарий!"})}),children:i.jsx(T,{dataSource:m,loading:r,renderItem:({title:c,description:o,createdAt:d,commentId:g,subCommentsCount:u,userId:l,userPicture:x})=>i.jsx(Nt,{code:t,title:c,userId:l,commentId:g,userPicture:x,description:o,subCommentsCount:u,createdAt:d})})})})},wt=Object.freeze(Object.defineProperty({__proto__:null,default:Et},Symbol.toStringTag,{value:"Module"}));export{wt as C,fe as I,vt as R};
